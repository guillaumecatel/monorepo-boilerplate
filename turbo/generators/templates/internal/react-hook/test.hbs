import { renderHook } from '@testing-library/react'
import { afterEach, beforeEach, describe, expect, it, vi } from 'vitest'

import {{ camelCase name }} from '@/{{ camelCase name }}'

describe('{{ camelCase name }}', () => {
  beforeEach(() => {
    vi.useRealTimers()
  })

  afterEach(() => {
    vi.restoreAllMocks()
  })

  it('should exec callback once', () => {
    const fn = vi.fn()

    const { rerender, unmount } = renderHook(() => {{ camelCase name }}(fn))

    expect(fn).toHaveBeenCalledTimes(1)

    // rerender should not execute again
    rerender()
    expect(fn).toHaveBeenCalledTimes(1)

    unmount()
  })

  it('should use the returned cleanup', () => {
    const cleanup = vi.fn()
    const fn = vi.fn(() => cleanup)

    const { unmount } = renderHook(() => {{ camelCase name }}(fn))
    expect(fn).toHaveBeenCalledTimes(1)
    expect(cleanup).toHaveBeenCalledTimes(0)

    unmount()

    expect(cleanup).toHaveBeenCalledTimes(1)
  })
})
